language: node_js
node_js:
- '4'
env:
  matrix:
  - TASK=npm run lint
  - TASK=npm run unittest GUI=1
  - TASK=npm run servertest
  - TASK=pip install --user -r requirements/flake8.txt && flake8 tests/ui/
cache:
  directories:
  - node_modules
before_install:
- npm install -g npm@3
- npm --version
before_script:
- if [ $GUI ]; then export DISPLAY=:99.0 && sh -e /etc/init.d/xvfb start && sleep 3; fi
script:
- $TASK
addons:
  firefox: latest
